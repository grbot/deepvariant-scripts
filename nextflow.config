params{
    sample_sheet = "/cbio/projects/020/gerrit/deepvariant-scripts/NA12878.samplesheet.small.tsv"
    out_dir = "/cbio/projects/020/gerrit/sentieon-scripts-dnascope-out"
    ref = "/cbio/projects/037/gerrit/ref/GCA_000001405.15_GRCh38_no_alt_analysis_set.fasta"
    memory_per_thread = "500M" // for samtools
    nr_cores = 32
}

executor{
    jobName = { "$task.tag" }
    queueSize = 100
    submitRateLimit = '10 min' // submit 10 jobs per minutde
}

process {
    cache = true

    withLabel: bwa {
         container = 'docker://quay.io/grbot/bwa-samtools:latest'
    }

    withLabel: deepvariant {
         container = 'docker://google/deepvariant:1.6.1'
         containerOptions = '--home /notexist -B /usr/lib/locale/:/usr/lib/locale/'
    }

    withLabel: bcftools {
         container = 'docker://quay.io/biocontainers/bcftools:1.21--h8b25389_0'
    }

    cpus = params.nr_cores
    time = 168.h
    errorStrategy = 'retry'
    maxRetries = 5
    maxErrors = 1000

}

profiles {
    standard {
        process.executor = 'local'
    }
    ilifu {
        process.executor = 'slurm'
        process.queue = 'Main'
        process.clusterOptions = '--account=b188-cbio-037-ag --reservation=refgraph'
    }
}

trace {
    enabled = true
    file = "trace.tsv"
    overwrite = true
}

report {
    enabled = true
    file = "report.html"
    overwrite = true
}

timeline {
    enabled = true
    file = "timeline.html"
    overwrite = true
}

singularity {
  autoMounts = true
  enabled = true
  cacheDir = "${HOME}/.singularity"
}
